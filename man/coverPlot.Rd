% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization.R
\name{coverPlot}
\alias{coverPlot}
\title{Plot SCEG-HiC Links and Tn5 Insertion Frequency Over a Genomic Region}
\usage{
coverPlot(
  object,
  focus_gene,
  species,
  genome,
  assay = NULL,
  upstream = 250000,
  downstream = 250000,
  HIC_Result = NULL,
  HIC_cutoff = 0,
  SCEG_HiC_Result = NULL,
  SCEG_HiC_cutoff = 0,
  correlation = NULL,
  cells = NULL,
  cellnames = NULL,
  eqtl.positions = NULL
)
}
\arguments{
\item{object}{A Seurat object.}

\item{focus_gene}{A character vector of gene symbols to focus on.}

\item{species}{Character string specifying the species name. Supported values are "Homo sapiens" or "Mus musculus".}

\item{genome}{Character string specifying the genome assembly. Supported values are "hg38", "hg19", "mm10", or "mm9".}

\item{assay}{Character or vector. Assay(s) to use. The first assay determines gene annotations and link metadata.}

\item{upstream}{Numeric specifying the number of base pairs upstream of each TSS to define enhancers. Default is 250,000 bp (250 kb).}

\item{downstream}{Numeric specifying the number of base pairs downstream of each TSS to define enhancers. Default is 250,000 bp (250 kb).}

\item{HIC_Result}{Data.frame. Hi-C gene-peak interaction result with columns \code{gene}, \code{peak}, \code{score}.}

\item{HIC_cutoff}{Numeric. Score threshold for Hi-C links. Default: 0.}

\item{SCEG_HiC_Result}{A data.frame containing the output from \code{Run_SCEG_HiC()}.}

\item{SCEG_HiC_cutoff}{Numeric. Score threshold for SCEG-HiC links. Recommend 0.01 for aggregated, 0.001 for single-cell.}

\item{correlation}{Data.frame. Correlation-based gene-peak links.}

\item{cells}{Character vector. Subset of cells to include.}

\item{cellnames}{Character vector. Name(s) of one or more metadata columns used to group the cells.
Default is the current cell identities.}

\item{eqtl.positions}{Numeric vector. Genomic positions of eQTL variants (optional).}
}
\value{
A \code{\link[patchwork]{patchwork}} plot.
}
\description{
This function visualizes Tn5 insertion signal across a given genomic window centered on a focus gene,
and overlays predicted and validated gene-enhancer (gene-peak) links.
}
\details{
The output includes:
\itemize{
\item{Tn5 insertion signal across cell groups}
\item{Links predicted by SCEG-HiC}
\item{Hi-C validated links}
\item{Correlation-based links}
\item{eQTL variants (optional)}
\item{Peak positions}
}
}
\examples{
data(multiomic_small)
SCEGdata <- process_data(multiomic_small, k_neigh = 5, max_overlap = 0.5)
fpath <- system.file("extdata", package = "SCEGHiC")
gene <- c("TRABD2A", "GNLY", "MFSD6", "CTLA4", "LCLAT1", "NCK2", "GALM", "TMSB10", "ID2", "CXCR4")
weight <- calculateHiCWeights(SCEGdata, species = "Homo sapiens", genome = "hg38", focus_gene = gene, averHicPath = fpath)
results_SCEGHiC <- Run_SCEG_HiC(SCEGdata, weight, focus_gene = gene)
fpath <- system.file("extdata", "multiomic_small_atac_fragments.tsv.gz", package = "SCEGHiC")
library(Signac)
frags <- CreateFragmentObject(path = fpath, cells = colnames(multiomic_small))
Fragments(multiomic_small) <- frags
coverPlot(multiomic_small, focus_gene = "CTLA4", species = "Homo sapiens", genome = "hg38", assay = "peaks", SCEG_HiC_Result = results_SCEGHiC, SCEG_HiC_cutoff = 0.01)
}
